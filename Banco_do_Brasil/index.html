<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <title>Dashboard</title>
</head>

<body>
  <div class="container">
    <div class="left-side">
      <div class="perfil">
        <img class="foto_perfil" src="assets/foto_perfil.png" alt="Foto de perfil" />
        <h2>José Ferreira</h2>
      </div>
      <nav class="navegacao">
        <a href="index.html"><svg xmlns="http://www.w3.org/2000/svg" id="icones" width="16" height="16"
            fill="currentColor" class="bi bi-house-door-fill" viewBox="0 0 16 16">
            <path
              d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5" />
          </svg>Componente 1</a>
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" id="icones" width="16" height="16" fill="currentColor"
            class="bi bi-wallet-fill" viewBox="0 0 16 16">
            <path
              d="M1.5 2A1.5 1.5 0 0 0 0 3.5v2h6a.5.5 0 0 1 .5.5c0 .253.08.644.306.958.207.288.557.542 1.194.542s.987-.254 1.194-.542C9.42 6.644 9.5 6.253 9.5 6a.5.5 0 0 1 .5-.5h6v-2A1.5 1.5 0 0 0 14.5 2z" />
            <path
              d="M16 6.5h-5.551a2.7 2.7 0 0 1-.443 1.042C9.613 8.088 8.963 8.5 8 8.5s-1.613-.412-2.006-.958A2.7 2.7 0 0 1 5.551 6.5H0v6A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5z" />
          </svg>Componente 2</a>
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" id="icones" width="16" height="16" fill="currentColor"
            class="bi bi-bell-fill" viewBox="0 0 16 16">
            <path
              d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901" />
          </svg> Notificação</a>
        <a href="#"> <svg xmlns="http://www.w3.org/2000/svg" id="icones" width="16" height="16" fill="currentColor"
            class="bi bi-graph-up-arrow" viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M0 0h1v15h15v1H0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5" />
          </svg>Investimentos</a>
      </nav>
    </div>

    <div class="right-side">
      <header class="weekly-progress-header">
        <div class="header-links">
          <a href="#">Início</a>
          <a href="#">Relatórios</a>
          <a href="#">Configurações</a>
        </div>
        <div class="weekly-progress" data-progress="0% concluído">
          <img id="weekly-progress-icon" src="assets/logo_0%.png" alt="Progresso Semanal">
        </div>
      </header>

      <div class="right-side-uper">
        <div class="progress-bar">
          <div class="progress-wrapper">
            <progress id="barraProgresso" value="0" max="100"></progress>
            <div><img class="progressImagens presente" data-index="0" src="assets/balao_surpresa.png" alt="Presente"></div>
            <div><img class="progressImagens presente" data-index="1" src="assets/balao_surpresa.png" alt="Presente"></div>
            <div><img class="progressImagens presente" data-index="2" src="assets/balao_surpresa.png" alt="Presente"></div>
          </div>
        </div>
      </div>

      <div class="right-side-lower">
        <div class="quests">
          <div class="dropdown-container">
            <button class="dropdown-button" onclick="toggleDropdown('tasksDropdown')">
              <h3>Tarefas em andamento</h3>
              <img class="logo" src="assets/logo.jpg" alt="">
            </button>
            <div class="dropdown-content" id="tasksDropdown">
              <div class="questsInAndament">
                <label class="checkbox-task">
                  <input type="checkbox" onchange="concluirTarefa(this, 0)" />
                  <span>Implementar login</span>
                </label>

                <label class="checkbox-task">
                  <input type="checkbox" onchange="concluirTarefa(this, 1)" />
                  <span>Criar API de usuários</span>
                </label>

                <label class="checkbox-task">
                  <input type="checkbox" onchange="concluirTarefa(this, 2)" />
                  <span>Estilizar dashboard</span>
                </label>

                <label class="checkbox-task">
                  <input type="checkbox" onchange="concluirTarefa(this, 3)" />
                  <span>Configurar banco de dados</span>
                </label>

                <label class="checkbox-task">
                  <input type="checkbox" onchange="concluirTarefa(this, 4)" />
                  <span>Desenvolver sistema de notificações</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="right-side-history">
          <div class="questsHistory" id="questsHistory">
            <h3>Histórico de tarefas</h3>
            <ul class="history-list">
              <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                  <path
                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                </svg> 10/04/2025 - Finalizado layout responsivo da página inicial</li>
              <li> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                  <path
                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                </svg> 12/04/2025 - Integração com banco de dados concluída</li>
              <li> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                  <path
                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                </svg> 15/04/2025 - Reunião de apnhamento com stakeholders</li>
              <li> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                  <path
                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                </svg> 18/04/2025 - Correções de bugs na interface de usuário</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="grafico">
        <img src="assets/Grafico.jpeg" alt="">
      </div>
    </div>
  </div>

  <script>
    // Configurações do sistema
    const config = {
      incremento: 20,
      marcos: [20, 50, 75, 100],
      presenteMarcos: [20, 50, 75],
      recompensas: [
        { img: 'assets/prata.png', mensagem: 'Você ganhou um badge de Prata!' },
        { img: 'assets/ouro.png', mensagem: 'Você ganhou um badge de Ouro!' },
        { img: 'assets/balao_icon.png', mensagem: 'Você desbloqueou uma recompensa especial!' }
      ]
    };

    // Estado da aplicação
    const state = {
      progressoAtual: 0,
      tarefasConcluidas: Array(5).fill(false),
      presentesDesbloqueados: [false, false, false],
      presentesAbertos: [false, false, false],
      semanaAtual: 0,
      semanasCompletas: 0,
      tarefasConcluidasNaSemana: 0
    };

    // Lista de tarefas por semana
    const tarefasPorSemana = [
      [
        "Implementar login",
        "Criar API de usuários",
        "Estilizar dashboard",
        "Configurar banco de dados",
        "Desenvolver sistema de notificações"
      ],
      [
        "Refatorar módulo de autenticação",
        "Otimizar consultas ao banco",
        "Implementar testes unitários",
        "Criar documentação da API",
        "Deploy em ambiente de staging"
      ],
      [
        "Desenvolver feature X",
        "Corrigir bugs críticos",
        "Atualizar dependências",
        "Implementar CI/CD",
        "Revisão de código em pares"
      ]
    ];

    // Elementos DOM
    const progresso = document.getElementById('barraProgresso');
    const presentes = document.querySelectorAll('.presente');
    const weeklyProgressIcon = document.getElementById('weekly-progress-icon');

    // Carrega progresso salvo
    function carregarProgresso() {
      const salvo = localStorage.getItem('progressoBB');
      if (salvo) {
        const dados = JSON.parse(salvo);
        state.semanasCompletas = dados.semanasCompletas || 0;
        state.semanaAtual = dados.semanaAtual || 0;
        atualizarIconeHeader();
      }
    }

    // Salva progresso
    function salvarProgresso() {
      localStorage.setItem('progressoBB', JSON.stringify({
        semanasCompletas: state.semanasCompletas,
        semanaAtual: state.semanaAtual
      }));
    }

    // Inicialização
    document.addEventListener('DOMContentLoaded', () => {
      carregarProgresso();
      presentes.forEach((presente, index) => {
        presente.addEventListener('click', () => abrirPresente(index));
      });
    });

    function toggleDropdown(dropdownId) {
      const dropdown = document.getElementById(dropdownId);
      const container = dropdown.closest('.dropdown-container');

      document.querySelectorAll('.dropdown-container').forEach(item => {
        if (item !== container) {
          item.classList.remove('dropdown-active');
        }
      });

      container.classList.toggle('dropdown-active');

      document.addEventListener('click', (e) => {
        if (!container.contains(e.target)) {
          container.classList.remove('dropdown-active');
        }
      }, { once: true });
    }

    function atualizarPresentes() {
      presentes.forEach((presente, index) => {
        if (state.progressoAtual >= config.presenteMarcos[index] && !state.presentesAbertos[index]) {
          if (!state.presentesDesbloqueados[index]) {
            presente.src = "assets/presente_bloqueado.png";
            presente.classList.add('presente-desbloqueado');
            state.presentesDesbloqueados[index] = true;
          }
        } else if (state.presentesAbertos[index]) {
          presente.src = config.recompensas[index].img;
          presente.classList.remove('presente-desbloqueado');
        }
      });
    }

    function abrirPresente(index) {
      if (state.presentesDesbloqueados[index] && !state.presentesAbertos[index]) {
        state.presentesAbertos[index] = true;
        const recompensa = config.recompensas[index];
        
        presentes[index].src = recompensa.img;
        presentes[index].classList.remove('presente-desbloqueado');
        
        const confettiConfig = {
          particleCount: 150,
          spread: 70,
          origin: { 
            x: (config.presenteMarcos[index] / 100) * 0.8 + 0.1,
            y: 0.6
          }
        };
        
        if (index === 1) {
          confettiConfig.particleCount = 200;
          confettiConfig.spread = 100;
          confettiConfig.colors = ['#FFD700', '#C0C0C0', '#FFFFFF'];
        }
        
        confetti(confettiConfig);
        
        Swal.fire({
          title: 'Presente aberto! 🎁',
          text: recompensa.mensagem,
          imageUrl: recompensa.img,
          imageWidth: 150,
          imageHeight: 150,
          imageAlt: 'Recompensa',
          confirmButtonText: 'Obrigado!'
        });
        
        atualizarPresentes();
      } else if (!state.presentesDesbloqueados[index]) {
        Swal.fire({
          title: 'Continue progredindo!',
          text: `Complete mais ${config.presenteMarcos[index] - state.progressoAtual}% para desbloquear este presente.`,
          icon: 'info',
          confirmButtonText: 'Vamos lá!'
        });
      } else if (state.presentesAbertos[index]) {
        const recompensa = config.recompensas[index];
        Swal.fire({
          title: 'Recompensa já resgatada',
          text: recompensa.mensagem,
          imageUrl: recompensa.img,
          imageWidth: 150,
          imageHeight: 150,
          imageAlt: 'Recompensa',
          confirmButtonText: 'Entendi'
        });
      }
    }

    function concluirTarefa(checkbox, index) {
      if (state.tarefasConcluidas[index]) {
        Swal.fire('Tarefa já concluída!', 'Esta tarefa já foi finalizada anteriormente.', 'info');
        checkbox.checked = true;
        return;
      }

      Swal.fire({
        title: 'Confirmar conclusão',
        text: 'Deseja marcar esta tarefa como concluída?',
        imageUrl: 'assets/Mascote_feliz.png',
        imageWidth: 200,
        imageHeight: 250,
        imageAlt: 'Mascote feliz',
        showCancelButton: true,
        confirmButtonColor: '#0571d3',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Sim, concluir!',
        cancelButtonText: 'Cancelar'
      }).then((result) => {
        if (result.isConfirmed) {
          state.tarefasConcluidas[index] = true;
          state.tarefasConcluidasNaSemana++;
          state.progressoAtual += config.incremento;
          
          checkbox.disabled = true;
          progresso.value = state.progressoAtual;
          atualizarPresentes();
          verificarMarcos();
          
          if (state.tarefasConcluidasNaSemana === tarefasPorSemana[state.semanaAtual].length) {
            state.semanasCompletas++;
            atualizarIconeHeader();
            salvarProgresso();
            celebrarConclusaoSemanal();
          }
        } else {
          Swal.fire({
            title: 'Ops! 😢',
            text: 'Você realmente deseja cancelar esta tarefa?',
            imageUrl: 'assets/Mascote-triste.png',
            imageWidth: 200,
            imageHeight: 250,
            imageAlt: 'Mascote triste',
            showCancelButton: true,
            confirmButtonColor: '#0571d3',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Não, quero concluir!',
            cancelButtonText: 'Sim, cancelar'
          }).then((secondResult) => {
            if (secondResult.isConfirmed) {
              checkbox.checked = true;
              concluirTarefa(checkbox, index);
            } else {
              checkbox.checked = false;
            }
          });
        }
      });
    }

    function verificarMarcos() {
      config.marcos.forEach(marco => {
        if (state.progressoAtual >= marco && state.progressoAtual - config.incremento < marco) {
          let confettiConfig = {
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          };
          
          if (marco >= 75) {
            confettiConfig.particleCount = 150;
            confettiConfig.colors = ['#FFD700', '#FFFFFF', '#0571d3'];
          }
          
          confetti(confettiConfig);
          
          Swal.fire({
            title: 'Marco alcançado! 🏆',
            html: `<p>Você atingiu <strong>${marco}%</strong> do seu objetivo!</p>
                  <p style="font-size: 0.9em; margin-top: 10px;">Continue assim!</p>`,
            icon: 'success',
            confirmButtonColor: '#0571d3',
            confirmButtonText: 'Rumo aos 100%!'
          });
        }
      });
    }

    function atualizarIconeHeader() {
      const porcentagemTotal = Math.min(state.semanasCompletas * 20, 100);
      const icone = `logo_${porcentagemTotal}%.png`;
      
      weeklyProgressIcon.src = `assets/${icone}`;
      weeklyProgressIcon.alt = `Progresso: ${porcentagemTotal}%`;
      document.querySelector('.weekly-progress').setAttribute('data-progress', `${porcentagemTotal}% concluído`);
      
      weeklyProgressIcon.classList.add('destaque-icone');
      setTimeout(() => {
        weeklyProgressIcon.classList.remove('destaque-icone');
      }, 1000);
    }

    function celebrarConclusaoSemanal() {
      confetti({
        particleCount: 300,
        spread: 100,
        origin: { y: 0.3 }
      });
      
      Swal.fire({
        title: 'Semana concluída! 🎉',
        html: `<p>Parabéns! Você completou todas as tarefas desta semana!</p>
              <p>Semanas completas: <strong>${state.semanasCompletas}/5</strong></p>
              <img src="assets/logo_${Math.min(state.semanasCompletas * 20, 100)}%.png" 
                   style="width: 100px; margin: 20px auto;">`,
        confirmButtonText: 'Iniciar nova semana!',
        confirmButtonColor: '#0571d3'
      }).then(() => {
        state.semanaAtual = (state.semanaAtual + 1) % tarefasPorSemana.length;
        resetarTarefas();
      });
    }

    function resetarTarefas() {
      state.tarefasConcluidas = Array(5).fill(false);
      state.tarefasConcluidasNaSemana = 0;
      state.progressoAtual = 0;
      state.presentesDesbloqueados = [false, false, false];
      state.presentesAbertos = [false, false, false];
      
      progresso.value = 0;
      
      const dropdownContent = document.getElementById('tasksDropdown');
      const novasTarefasHTML = tarefasPorSemana[state.semanaAtual]
        .map((tarefa, index) => `
          <label class="checkbox-task">
            <input type="checkbox" onchange="concluirTarefa(this, ${index})" />
            <span>${tarefa}</span>
          </label>
        `).join('');
      
      dropdownContent.querySelector('.questsInAndament').innerHTML = novasTarefasHTML;
      
      document.querySelectorAll('.presente').forEach(presente => {
        presente.src = "assets/balao_surpresa.png";
        presente.classList.remove('presente-desbloqueado');
      });
    }
  </script>
</body>
</html>